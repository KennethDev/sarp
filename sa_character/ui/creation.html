<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="">
		<meta name="author" content="">
		<!-- Bootstrap Core CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<!-- Custom CSS -->
		<link href="css/homepage.css" rel="stylesheet">
		<script src="js/jquery.js" type="text/javascript"></script>
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<img id="cursor" src="cursor.webp" style="position: absolute; display:none; z-index: 99;">
		<nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
	      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
	        <span class="navbar-toggler-icon"></span>
	      </button>
	      <a class="navbar-brand" href="#">High Life Roleplay</a>

	      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
	        <ul class="navbar-nav mr-auto">
	        </ul>
	      </div>
	    </nav>
		<div class="container">
			<div class="row">
				<h1>Character Creation</h1>
			</div>
			<div class="row">
			<p>Welcome to High Life Roleplay! In order to get started on our server, you will need to create a roleplay character.</p>
			</div>
			<hr>
			<div class="row">
				<div class="col-md-4">
					<form id="daform">
						<div class="form-group">
							<label for="first_name"><strong>First Name</strong></label>
						    <input type="text" class="form-control" id="first_name" aria-describedby="first_name_help" placeholder="Example: John">
						    <small id="first_name_help" class="text-muted">Must be 3-20 Letters Long</small>
					    </div>
					    <div class="form-group">
							<label for="last_name"><strong>Last Name</strong></label>
						    <input type="text" class="form-control" id="last_name" aria-describedby="last_name_help" placeholder="Example: Smith">
						    <small id="last_name_help" class="text-muted">Must be 3-20 Letters Long</small>
					    </div>
					    <div class="form-group">
					   		<label for="dob"><strong>Date of Birth</strong></label>
						    <input type="date" class="form-control" id="dob" aria-describedby="last_name_help" value="1980-01-20">
						    <small id="last_name_help" class="text-muted">Format is MM/DD/YYYY (Month, Day, Year)</small>
					    </div>
					    <div class="form-group">
							<label for="gender"><strong>Gender</strong></label>
						    <select class="form-control" id="gender" aria-describedby="gender_help">
						    	<option value="0">Male</option>
						    	<option value="1">Female</option>
						    </select>
						    <small id="gender_help" class="text-muted">Click and use arrow keys to change.</small>
					    </div>
					    <input type="hidden" name="race" id="race" value="0">
					</form>
				</div>
				<div class="col-md-4" id="middle">
					<p>By creating a character and playing on High Life, you agree to follow common sense rules as well as those listed in /rules. You also aknowledge that you are unable to change this information later unless you wish to lose money doing so.</p>
					<div class="form-check">
				  		<label class="form-check-label">
				    		<input type="checkbox" class="form-check-input" id="agreement">
				    		I agree to the statement above.
				    	</label>
					</div>
					<button class="btn btn-primary btn-block" id="create" onclick="validate()">Create Character</button>
				</div>
				<div class="col-md-4">
					<p id="error" style="color:red"></p>
				</div>
			</div>
		</div>
		<div class="container">
			<hr>
			<footer>
				<div class="row">
					<div class="col-lg-12">
						<p>Copyright &copy;2017 High Life Roleplay.</p>
					</div>
				</div>
			</footer>
		</div>
		<script src="js/jquery.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script>
			var documentWidth = document.documentElement.clientWidth;
			var documentHeight = document.documentElement.clientHeight;
			
			var cursor = document.getElementById("cursor");
			var cursorX = documentWidth / 2;
			var cursorY = documentHeight / 2;
			
			function UpdateCursorPos() {
			    $(cursor).css('left', cursorX)
			    $(cursor).css('top', cursorY)
			}
			
			function Click(x, y) {
			    var element = $(document.elementFromPoint(x, y));
			    element.focus().click();
			}
			
			function validate() {
				var first_name	= $("#first_name").val();
				var last_name	= $("#last_name").val();
				var dob			= $("#dob").val();
				var gender		= $("#gender").val();
				var race		= $("#race").val();
				var agreement	= $("#agreement");
				var valid		= true;
				var error		= "";
				if (checkAlpha(first_name) == false) {
					valid = false;
					error = error + "Please make sure that your first name is all letters.<br /><br />";
				}
				if (first_name.length < 3 || first_name.length > 20) {
					valid = false;
					error = error + "Please make sure that your first name is between 3 and 20 letters long.<br /><br />";
				}
				if (checkAlpha(last_name) == false) {
					valid = false;
					error = error + "Please make sure that your last name is all letters.<br /><br />";
				}
				if (last_name.length < 3 || last_name.length > 20) {
					valid = false;
					error = error + "Please make sure that your last name is between 3 and 20 letters long.<br /><br />";
				}
				if (agreement.is(":checked") == false) {
					valid = false;
					error = error + "Please agree to the statement.<br /><br />";
				}
				if (valid) {
					$.post('http://sa_character/create', JSON.stringify({fn: first_name, ln: last_name, dob: dob, gender: gender, race: race}));
					$("#daform").html("Creating Character...");
					$("#middle").html("Creating Character...");
					$("#error").html("Please wait for a moment.");
				} else {
					$("#error").html(error);
				}
			}

			$(function() {
				$(cursor).css('display', "none")
				$("body").css('display', "none")
				$("body").css('background', 'none')
			    window.addEventListener('message', function(event) {
			        if (event.data.type == "enableui") {
			            $(cursor).css('display', event.data.enable ? "block" : "none")
			            $("body").css('display', event.data.enable ? "block" : "none")
			            $("body").css('background', event.data.enable ? "white" : "none")
			
			        } else if (event.data.type == "click") {
			            // Avoid clicking the cursor itself, click 1px to the top/left;
			            Click(cursorX - 1, cursorY - 1);
			        }
			    });
			
			    $(document).mousemove(function(event) {
			        cursorX = event.pageX;
			        cursorY = event.pageY;
			        UpdateCursorPos();
			    });
			
			    //document.onkeyup = function (data) {
			    //    if (data.which == 27) { // Escape key
			    //        $.post('http://sa_character/escape', JSON.stringify({}));
			    //    }
			    //};
			});
			function checkAlpha(text) {
				var letters = /^[A-Za-z]+$/;
				if (text.match(letters)) {
					return true;
				} else {
					return false;
				}
			}
		</script>
	</body>
</html>